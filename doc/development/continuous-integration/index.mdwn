[[!meta title="Continuous integration"]]

# Services

## GitHub Actions

- Reference: <https://docs.github.com/en/free-pro-team@latest/actions/reference>.

- Storing artifacts inside of a workflow <https://docs.github.com/en/free-pro-team@latest/actions/guides/storing-workflow-data-as-artifacts>.
- Caching <https://docs.github.com/en/free-pro-team@latest/actions/guides/caching-dependencies-to-speed-up-workflows>.
- Container registry <https://github.blog/2020-09-01-introducing-github-container-registry/>
    * <https://docs.github.com/en/free-pro-team@latest/packages/getting-started-with-github-container-registry/about-github-container-registry>
- Problem matcher <https://github.com/actions/toolkit/blob/master/docs/problem-matchers.md>

Examples:

- Perl
    * <https://perlmaven.com/github-actions-running-on-3-operating-systems>
    * <https://github.com/tobyink/p5-app-ghaprove/blob/master/.github/workflows/ci.yml>

## Travis CI

- Build stages <https://docs.travis-ci.com/user/build-stages/>.
- Storing artifacts inside of stages <https://docs.travis-ci.com/user/using-workspaces/>.

## AppVeyor

- [[Environment variables - AppVeyor|https://www.appveyor.com/docs/environment-variables/]]
- [[Software pre-installed on Windows build VMs - AppVeyor|https://www.appveyor.com/docs/windows-images-software/]]

# Design of CI configuration

- Script
    * Bourne shell script
    * PowerShell script
- Script should be source-able using the same script for every CI service
  (because generating multiple scripts means changing those scripts). Then the
  script in turn should do something different based on which CI is being used
  (detected using the environment variables).
- e.g.
    * Travis CI:
        [[!format txt """
        install: skip
        script: eval $(curl .../bootstrap.sh )
        """]]
    * AppVeyor:
        [[!format txt """
        build: off
        test_script:
          - ps: . { iwr -useb .../bootstrap.ps1 } | iex
        """]]
    * GitHub Actions:
        [[!format txt """
        jobs:
          build:
            runs-on: ubuntu-latest
            steps:
              - uses: actions/checkout@v2
              - name: Run Orbital Transfer
                run: |
                  sudo apt-get install ikiwiki libtext-multimarkdown-perl
        """]]
